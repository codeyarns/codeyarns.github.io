<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <meta name="author" content="Ashwin Nanjappa">
  <title>Code Yarns â€“ PageDefrag: Does not work with Windows 7</title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="../styles.css">
  <!-- RSS feed -->
  <link rel="alternate" type="application/rss+xml" href="https://codeyarns.com/tech/rss.xml" />
</head>

<body>

<div class="contentbox">
<!-- BEGIN before body -->

<!-- Website title -->
<div class="header">
    <a href=".." class="header">Code Yarns â€ğŸ‘¨â€ğŸ’»</a>
</div>

<!-- Blog links -->
<div class="header">
    <a class="header2" href="https://codeyarns.com/tech/">Tech Blog</a> â– <a class="header2" href="https://codeyarns.com/personal/">Personal Blog</a>
</div>

<!-- Search box -->
<br />
<link href="/pagefind/pagefind-ui.css" rel="stylesheet">
<script src="/pagefind/pagefind-ui.js"></script>
<div id="search"></div>
<script>
    window.addEventListener('DOMContentLoaded', (event) => {
        new PagefindUI({ element: "#search", showSubResults: true });
    });
</script>

<!-- END before body -->
</div>

<br />

<div class="contentbox">
<header>
<h1 class="title">PageDefrag: Does not work with Windows 7</h1>
<p class="date">ğŸ“… 2010-Jan-13 â¬© âœï¸ Ashwin Nanjappa â¬© ğŸ·ï¸ <a href='index.html#defragmentation'>defragmentation</a>, <a href='index.html#pagedefrag'>pagedefrag</a>, <a href='index.html#sysinternals'>sysinternals</a>, <a href='index.html#windows'>windows</a> â¬© ğŸ“š <a href="index.html">Archive</a></p>
</header>
<figure>
<img
src="http://codeyarns.files.wordpress.com/2010/01/2010_01_13_pagedefrag.png"
alt="Â " />
<figcaption aria-hidden="true">Â </figcaption>
</figure>
<p><strong><a
href="http://technet.microsoft.com/en-us/sysinternals/bb897426.aspx">PageDefrag</a></strong>
is a useful utility from SysInternals, now owned by Microsoft, that can
defragment the <strong>page file</strong>
(<code>C:\pagefile.sys</code>), registry hives, log files and the
<strong>hibernation file</strong> (<code>C:\hiberfil.sys</code>).
Typically these files cannot be defragmentedÂ  while Windows is running
since they are open for use. PageDefrag would schedule a defragmentation
of these files during Windows boot time. This utility has been working
well for me with Windows XP for many years now.</p>
<p>PageDefrag now seems to be useless with Windows 7. The PageDefrag
dialog shows an empty list, where as it should have listed the above
files. And if scheduled for boot time defragmentation, it gives a
â€œ<code>page file not found</code>â€ message. Thankfully, there are no
error messages on Windows 7. Vista users have <a
href="http://forum.sysinternals.com/forum_posts.asp?TID=10755">seen
errors</a>. I do not see any updates to PageDefrag since its last
release in 2006 and it has been many years now since Vista was released.
I guess it is RIP for PageDefrag on Vista/Windows 7 then! â˜¹</p>
<p><strong>Update:</strong> Mark Russinovich confirms that PageDefrag
works <strong>only</strong> on the x86 editions of Windows XP and Server
2003. This note can be found on page 345 of the <strong>Windows
Sysinternals Administrators Reference</strong>.</p>
</div>

<br />

<div class="contentbox">

<div style="text-align: center">
Â© 2026 Ashwin Nanjappa
â€¢
All writing under <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA</a> license
â€¢
<a href="https://mastodon.social/@codeyarns">ğŸ˜ Mastodon</a>
â€¢
<a href="https://bsky.app/profile/codeyarns.bsky.social">ğŸ¦‹ Bluesky</a>
â€¢
<a href="mailto:codeyarns@gmail.com">ğŸ“§ Email</a>
</div>
</div>

</body>
</html>
