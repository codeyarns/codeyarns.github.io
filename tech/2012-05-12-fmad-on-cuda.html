<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Ashwin Nanjappa" />
  <title>FMAD on CUDA</title>
  <style type="text/css">code{white-space: pre;}</style>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-143311697-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'UA-143311697-1');
  </script>
</head>
<body>
<div id="header">
<h1 class="title">FMAD on CUDA</h1>
<h2 class="author">Ashwin Nanjappa</h2>
<h3 class="date">2012-05-12 07:24:55+00:00</h3>
</div>
<p>[caption id=&quot;attachment_2543&quot; align=&quot;aligncenter&quot; width=&quot;812&quot;][<img src="https://codeyarns.files.wordpress.com/2012/05/20120512-fmad.png" />](https://codeyarns.files.wordpress.com/2012/05/20120512-fmad.png) PTX instructions produced with FMAD off (left) and FMAD on (right)[/caption]</p>
<p>If you are using <strong>CUDA</strong> to perform any sort of non-graphics <strong>floating-point computation</strong>, be aware of the <strong>FMAD</strong> (floating-point multiply-add) instruction. Since CUDA hardware needs to straddle not only the world of computation, but also graphics and gaming, it has lots of FMAD units. So, by default the CUDA compiler will try to replace as much of your floating-point computation code with FMAD instructions.</p>
<p>This is fine if you do not rely on the precision of your results. However, this can lead to hard-to-find bugs if you do rely on the precision. If you need the CUDA computation to mimic the floating-point computation on the CPU, then you are better off without the FMAD instructions.</p>
<p>The CUDA compiler (<code>nvcc</code>) is configured to produce FMAD instructions by default. To request it to stop producing FMAD instructions and use the normal floating-point instructions use the compiler directive <code>--fmad=false</code></p>
<p>Note that turning off FMAD can hurt performance quite a bit. I found that the time spent on my computations increased by about 20% with FMAD turned off.</p>
<p><strong>Tried with:</strong> CUDA 4.1</p>
</body>
</html>
