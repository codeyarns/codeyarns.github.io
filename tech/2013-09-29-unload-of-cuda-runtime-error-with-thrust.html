<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Ashwin Nanjappa" />
  <title>Unload of CUDA runtime error with Thrust</title>
  <style type="text/css">code{white-space: pre;}</style>
</head>
<body>
<div id="header">
<h1 class="title">Unload of CUDA runtime error with Thrust</h1>
<h2 class="author">Ashwin Nanjappa</h2>
<h3 class="date">2013-09-29 14:06:34+00:00</h3>
</div>
<p><strong>Problem</strong></p>
<p>Your <strong>CUDA</strong> program that uses the <strong>Thrust</strong> library executes correctly, but at the end throws up this error:</p>
<pre><code>terminate called after throwing an instance of &#39;thrust::system::system_error&#39;
what():  unload of CUDA runtime failed</code></pre>
<p><strong>Solution</strong></p>
<p>This cryptic error typically occurs if you are using Thrust <code>device_vector</code> in your program. I found that this error occurs when I have a <code>device_vector</code> which is destroyed after the CUDA runtime has been unloaded.</p>
<p>For example, this can happen if you have declared a vector as a global variable. At the end of the program, the CUDA runtime is unloaded. If the destructor of the vector is called after this, it cannot destroy fully since it needs the CUDA runtime. Moving these global vectors inside functions or classes might fix the error.</p>
<p><strong>Tried with:</strong> CUDA 5 and Ubuntu 12.04 LTS</p>
</body>
</html>
