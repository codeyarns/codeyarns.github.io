<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <meta name="author" content="Ashwin Nanjappa">
  <title>Code Yarns â€“ Unload of CUDA runtime error with Thrust</title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="../styles.css">
  <!-- RSS feed -->
  <link rel="alternate" type="application/rss+xml" href="https://codeyarns.github.io/tech/rss.xml" />
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-143311697-1">
  </script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'UA-143311697-1');
  </script>
</head>
<body>
<table style="width: 100%;">
    <tr>
        <td>
            <a href=".." class="header">Code Yarns &#128187;</a>
        </td>
        <td style="text-align: right;">
            <iframe src="https://duckduckgo.com/search.html?site=codeyarns.github.io&kp=-2&kc=1&prefill=Search this website" style="overflow:hidden;margin:0;padding:0;width:300px;height:40px;" frameborder="0"></iframe>
        </td>
    </tr>
</table>
<hr />
<header>
<h1 class="title">Unload of CUDA runtime error with Thrust</h1>
<p class="date">(First posted on: 2013-09-29 14:06:34+00:00)</p>
</header>
<p><strong>Problem</strong></p>
<p>Your <strong>CUDA</strong> program that uses the <strong>Thrust</strong> library executes correctly, but at the end throws up this error:</p>
<pre><code>terminate called after throwing an instance of &#39;thrust::system::system_error&#39;
what():  unload of CUDA runtime failed</code></pre>
<p><strong>Solution</strong></p>
<p>This cryptic error typically occurs if you are using Thrust <code>device_vector</code> in your program. I found that this error occurs when I have a <code>device_vector</code> which is destroyed after the CUDA runtime has been unloaded.</p>
<p>For example, this can happen if you have declared a vector as a global variable. At the end of the program, the CUDA runtime is unloaded. If the destructor of the vector is called after this, it cannot destroy fully since it needs the CUDA runtime. Moving these global vectors inside functions or classes might fix the error.</p>
<p><strong>Tried with:</strong> CUDA 5 and Ubuntu 12.04 LTS</p>
<hr />
<p><a href="rss.xml">RSS</a> - <a href="mailto:codeyarns@gmail.com">Contact</a></p>
</body>
</html>
