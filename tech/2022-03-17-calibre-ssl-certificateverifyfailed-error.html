<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <meta name="author" content="Ashwin Nanjappa">
  <title>Code Yarns ‚Äì Calibre SSL CERTIFICATE_VERIFY_FAILED error</title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="../styles.css">
  <!-- RSS feed -->
  <link rel="alternate" type="application/rss+xml" href="https://codeyarns.com/tech/rss.xml" />
  <!-- Microsoft Clarity Analytics -->
  <script type="text/javascript">
      (function(c,l,a,r,i,t,y){
          c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
          t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
          y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
      })(window, document, "clarity", "script", "3wadqgw95m");
  </script>
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-143311697-1">
  </script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'UA-143311697-1');
  </script>
  <!-- Google Adsense -->
  <script data-ad-client="ca-pub-1956250892185343" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js">
  </script>
  <!-- Twitter button -->
  <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</head>

<body>

<div class="contentbox">
<div class="header">
    <a href=".." class="header">Code Yarns ‚Äçüë®‚Äçüíª</a>
  </div>
  <div class="header">
    <a class="header2" href="https://codeyarns.com/tech/">Tech Blog</a> ‚ùñ <a class="header2" href="https://codeyarns.com/personal/">Personal Blog</a>
  </div>
  <div class="header" style="padding-top: 10px;">
    <iframe src="https://duckduckgo.com/search.html?site=codeyarns.com&kp=-2&kc=1&prefill=Search this website" style="width:300px;height:40px;" frameborder="0"></iframe>
</div>
</div>

<br />

<div class="contentbox">
<header>
<h1 class="title">Calibre SSL CERTIFICATE_VERIFY_FAILED error</h1>
<p class="date">üìÖ 2022-Mar-17 ‚¨© ‚úçÔ∏è Ashwin Nanjappa ‚¨© üè∑Ô∏è <a href='index.html#calibre'>calibre</a>, <a href='index.html#error'>error</a> ‚¨© üìö <a href="index.html">Archive</a></p>
</header>
<h2 id="problem">Problem</h2>
<p>I tried to use the <strong>Fetch News</strong> feature in <strong>Calibre</strong> to download a news source which had a RSS feed. The download job finished quickly, but the generated ebook had no pages, but had this error:</p>
<pre><code>Traceback (most recent call last):
  File &quot;mechanize\_urllib2_fork.py&quot;, line 1236, in do_open
  File &quot;http\client.py&quot;, line 1255, in request
  File &quot;http\client.py&quot;, line 1301, in _send_request
  File &quot;http\client.py&quot;, line 1250, in endheaders
  File &quot;http\client.py&quot;, line 1010, in _send_output
  File &quot;http\client.py&quot;, line 950, in send
  File &quot;http\client.py&quot;, line 1424, in connect
  File &quot;ssl.py&quot;, line 500, in wrap_socket
  File &quot;ssl.py&quot;, line 1040, in _create
  File &quot;ssl.py&quot;, line 1309, in do_handshake
  ssl.SSLCertVerificationError: [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: certificate has expired (_ssl.c:1123)</code></pre>
<p>The same RSS feed or webpage opened without any problem in Firefox, Chrome, Edge and Internet Explorer.</p>
<h2 id="solution">Solution</h2>
<p>This error is apparently due to an expired root certificate from <em>Let‚Äôs Encrypt</em> that might be stored in your Windows.</p>
<p>Calibre uses the Mechanize library to create a browser object and downloads pages using that. That object uses the root certificates from Windows and so is affected by the expired root certificate. The browsers have their own certificate store and so they are unaffected.</p>
<p>To delete the expired certificate:</p>
<ul>
<li>Open the Certificates Manager by starting <code>certmgr.msc</code>. This shows the certificates in the stores on your Windows.</li>
<li>In the left pane, choose <em>Intermediate Certification Authorities</em> -&gt; <em>Certificates</em>.</li>
<li>In the right pane, choose the <em>R3</em> certificate from Let‚Äôs Encrypt. Make sure that its <em>Expiration Date</em> is in the past. If so, delete it.</li>
<li>Close the Certificates Manager.</li>
</ul>
<p>After this, Calibre should be able to download the news.</p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://borncity.com/win/2021/09/30/sept-30-2021-will-we-see-trouble-with-old-lets-encrypt-certificates/">Trouble with old Let‚Äôs Encrypt certificates</a></li>
<li><a href="https://www.mobileread.com/forums/showpost.php?p=4158860&amp;postcount=1139">Problem with accessing OverDrive libraries</a></li>
<li><a href="https://bugs.launchpad.net/calibre/+bug/1947407">Calibre bug on this issue</a></li>
</ul>
<p><strong>Tried with:</strong> Calibre 5.38</p>
</div>

<br />

<div class="contentbox">

<div class="footer"><a href="mailto:codeyarns@gmail.com" style="text-decoration: none; font-size: xx-large;">üìß</a> <a href="https://twitter.com/codeyarns" class="twitter-follow-button" data-show-count="false" data-size="large">Follow @codeyarns</a> <a href="https://www.buymeacoffee.com/codeyarns"><img src="https://cdn.buymeacoffee.com/buttons/default-orange.png" alt="Buy Me A Coffee" style="height: 38px !important;width: 163px !important;" ></a></div>
</div>

</body>
</html>
