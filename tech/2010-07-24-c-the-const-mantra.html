<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Ashwin Nanjappa" />
  <title>Code Yarns â€“ C++: The const Mantra</title>
  <style type="text/css">code{white-space: pre;}</style>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-143311697-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'UA-143311697-1');
  </script>
</head>
<body>
<a href="..">Code Yarns</a> / <a href="index.html">Tech</a>
<hr />
<div id="header">
<h1 class="title">C++: The const Mantra</h1>
<h3 class="date">2010-07-24 05:30:49+00:00</h3>
</div>
<p><a href="http://codeyarns.files.wordpress.com/2010/07/2010_07_24_const_mantra.png"><img src="http://codeyarns.files.wordpress.com/2010/07/2010_07_24_const_mantra.png" /></a></p>
<p>The <strong>const mantra</strong> to keep in mind while writing C++ code is to <strong>make everything const</strong>, that is, as much as possible. Typing 5 extra letters everywhere might seem like extra work, especially to C gurus, but the paybacks of const can be quite significant over time. It is one extra nail hammered into the code to ensure that the code behaves exactly as envisioned in the head of the programmer. Once the vision of the programmer has been converted to code, const helps in ensuring the correctness of this code by pushing the burden of this checking onto the compiler. Thus bugs can be caught much earlier, at compile time. The const code will also behave much nicer with STL and other libraries that give special emphasis to const. They might have faster and/or more robust implementations for const.</p>
<p>Here are some simple guidelines to const the code:</p>
<ul>
<li><p>Whenever possible, const all <strong>input parameters</strong> to a method that are <strong>passed by reference</strong>. That is, const all input reference and pointer variables that will not be modified inside the method. Making a pass-by-value input parameter (like int) as const is typically not useful. <code>cpp void FooContainer::append( const FooContainer&amp; );</code></p></li>
<li><p>Whenever possible, const all methods that do not change the underlying object. <code>cpp void FooContainer::display() const;</code></p></li>
<li><p>Whenever possible, do both of the above. <code>cpp void FooContainer::displayWithIndex( const FooVector&amp; ) const;</code></p></li>
<li><p>Whenever possible, const all variables defined inside the method that will not be modified once initialized. This might sound obvious, but very few people do this since it seems like too much work. The benefits start to pay off once you start seeing the <strong>immutable</strong> (const) and <strong>mutable</strong> moving parts churning inside the engine of the method by just glancing over it. It is like wearing 3D glasses, yes, get the extra dimension to your vision! ;-) <code>cpp void FooContainer::display() const { const int max = size(); // *** }</code></p></li>
<li><p>Whenever possible, use <strong>const_iterator</strong>, <strong>cbegin</strong> and <strong>cend</strong> when using STL. cbegin and cend are introduced in C++0X and you can use them if you are using Visual C++ 2010. <code>cpp for ( FooVector::const_iterator i = fooVec.cbegin(); i != fooVec.cend(); ++i ) { /***/ }</code></p></li>
</ul>
<p>Note that injecting your code with the const vaccine will have some initial side-effects. The const introduced in one method starts to spread virally through your code, giving const related compile errors. This forces you to re-think the assumptions of your code, re-factor and re-write a lot of your code. Yes, this is good for you and your code. Go gain your const-vision! :-D</p>
<hr />
<p><a href="mailto:codeyarns@gmail.com?subject=%22Comment%20about%20Code%20Yarns%20blog%20post%22">Contact</a></p>
</body>
</html>
