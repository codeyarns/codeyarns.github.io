<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <meta name="author" content="Ashwin Nanjappa">
  <title>Code Yarns â€“ Explicit Constructor in C++</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  </style>
  <link rel="stylesheet" href="../styles.css">
  <!-- RSS feed -->
  <link rel="alternate" type="application/rss+xml" href="https://codeyarns.github.io/tech/rss.xml" />
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-143311697-1">
  </script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'UA-143311697-1');
  </script>
  <!-- Google Site Search -->
  <script async src="https://cse.google.com/cse.js?cx=003521915278168649297:cryrlg7hahe">
  </script>
</head>
<body>
<table style="width: 100%;">
    <tr>
        <td>
            <a href=".." class="header">Code Yarns &#128187;</a>
        </td>
        <td>
            <div class="gcse-search"></div>
        </td>
    </tr>
</table>
<hr />
<header>
<h1 class="title">Explicit Constructor in C++</h1>
<p class="date">(First posted on: 2010-12-17 02:46:55+00:00)</p>
</header>
<p>A <strong>C++</strong> constructor acts like an implicit type converter whenever it is needed. In the example below, the <code>Foo( int )</code> constructor acts like an int-to-Foo type converter for the function <code>doSomething</code>.</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="kw">class</span> Foo
{
<span class="kw">public</span>:
    Foo( <span class="dt">int</span> x ) { _val = x; }
<span class="kw">private</span>:
    <span class="dt">int</span> _val;
};

<span class="dt">void</span> doSomething( <span class="at">const</span> Foo &amp;foo )
{}

doSomething( <span class="dv">10</span> ); <span class="co">// Acts like doSomething( Foo( 10 ) );</span></code></pre></div>
<p>Only constructors with one non-default parameter can act like implicit convertors. That is, a constructor with only one parameter, which is not a default parameter. Or a constructor with many parameters, where the first parameter is not default and the rest of the parameters are default parameters. In the example below, the constructor with many parameters also acts like an implicit int-to-Foo convertor since all but one are default parameters.</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="kw">class</span> Foo
{
<span class="kw">public</span>:
    Foo( <span class="dt">int</span> x, <span class="dt">int</span> y = <span class="dv">99</span>, <span class="dt">int</span> z = <span class="dv">999</span> ) { _val = x; }
<span class="kw">private</span>:
    <span class="dt">int</span> _val;
};

<span class="dt">void</span> doSomething( <span class="at">const</span> Foo &amp;foo )
{}

doSomething( <span class="dv">10</span> );</code></pre></div>
<p>With the inherent complexity of C++, most programmers do not want such implicit conversions happening under the hood. To prevent this from happening, the <strong>explicit</strong> qualifier can be used on such constructors. The example below does not allow implicit conversion.</p>
<div class="sourceCode"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span class="kw">class</span> Foo
{
<span class="kw">public</span>:
    <span class="kw">explicit</span> Foo( <span class="dt">int</span> x ) { _val = x; }
<span class="kw">private</span>:
    <span class="dt">int</span> _val;
};

<span class="dt">void</span> doSomething( <span class="at">const</span> Foo&amp;amp; foo )
{}

doSomething( <span class="dv">10</span> );        <span class="co">// Error!</span>
doSomething( Foo( <span class="dv">10</span> ) ); <span class="co">// OK</span></code></pre></div>
<p>A few notes:</p>
<ul>
<li><p>The explicit qualifier can be used only with the constructor declaration, not the definition (if the two are separate).</p></li>
<li><p>The explicit qualifier can be used on <em>any</em> constructor. Even the default constructor or constructors with many non-default parameters. It is allowed for these, but does not seem to serve any purpose.</p></li>
</ul>
<p>Since explicit prevents such under-the-hood activities, it is a good habit to apply it by default on all constructors. Turn it off only when you actually need an implicit conversion. :-)</p>
<hr />
<p><a href="rss.xml">RSS</a> - <a href="mailto:codeyarns@gmail.com">Contact</a></p>
</body>
</html>
